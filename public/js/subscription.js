(()=>{var e,n,i,o,a,s,t,d,r,c,l=!1;function p(){var e=s.val(),n=s.data("url");a.prop("disabled",!0).find(".check").hide().parent().find(".spinner").show(),e||o.removeClass("disabled").prop("disabled",!1),$.ajax({url:n+"?coupon="+e,context:this}).done((function(e){if(a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),o.removeClass("disabled").prop("disabled",!1),!e.valid)return t.hide(),d.html(e.error).show(),r.val(""),void c.removeClass("valid-coupon");d.hide(),t.html(e.discount).show(),r.val(e.coupon),c.addClass("valid-coupon")})).fail((function(e){a.prop("disabled",!1).find(".check").show().parent().find(".spinner").hide(),e.responseJSON&&d.html(e.responseJSON.message).show()}))}$(document).ready((function(){var u;u=$("#stripe-token"),e=Stripe(u.val()),n=e.elements(),$('input[name="period"]').change((function(){var e=$("#pricing-overview");console.log("checked?",this.checked),this.checked?e.removeClass("period-month").addClass("period-year"):e.removeClass("period-year").addClass("period-month")})),(c=$("#subscribe-confirm")).on("shown.bs.modal",(function(){!function(){if(o=$(".subscription-confirm-button"),1===$("#card-element").length){if(!i){var c={base:{color:"#555555",fontFamily:'"Helvetica Neue", Helvetica, sans-serif',fontSmoothing:"antialiased",fontSize:"14px","::placeholder":{color:"#777777"}},invalid:{color:"#fa755a",iconColor:"#fa755a"}};i=n.create("card",{hidePostalCode:!0,style:c})}i.mount("#card-element")}$("#subscription-confirm").submit((function(n){if(l)return!0;n.preventDefault(),o.addClass("disabled"),o.find("span").hide(),o.find(".spinner").show();var a=$('input[name="subscription-intent-token"]'),s=$(".alert-danger");s.hide();var t=$('input[name="payment_id"]');if(t.val())return l=!0,$("#subscription-confirm").submit(),!1;e.confirmCardSetup(a.val(),{payment_method:{card:i,billing_details:{name:$('input[name="card-holder-name"]').val()}}}).then(function(e){if(e.error)return o.removeClass("disabled").text(o.data("text")),s.text(e.error.message).show(),!1;t.val(e.setupIntent.payment_method),l=!0,$("#subscription-confirm").submit()}.bind(this))})),$(".subscription-form").submit((function(){return o.addClass("disabled").find("span").hide().parent().find(".spinner").show(),!0})),a=$("#coupon-check-btn"),s=$("#coupon-check"),t=$("#coupon-success"),d=$("#coupon-invalid"),r=$("#coupon"),a.click((function(){p()})),s.change((function(){p()})),s.focus((function(){o.addClass("disabled").prop("disabled",!0)})),s.focusout((function(){s.val()||o.removeClass("disabled").prop("disabled",!1)}))}()}))}))})();
//# sourceMappingURL=subscription.js.map